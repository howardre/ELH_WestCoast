---
title: "RREAS Data Exploration"
author: "Rebecca Howard"
output: html_document
---

```{r setup, include = FALSE}
### Load libraries
library(readxl)
library(plyr)
library(tibble)
library(here)
library(ggplot2)
library(lubridate)
library(date)
library(dplyr)
library(maps)
library(mapdata)
library(gridExtra)
library(grid)
library(reshape2)
library(rerddap)
```

Functions
```{r, include = FALSE, echo = FALSE}
# Extract from ERDDAP
extract_ERDDAP <- function(info, variable_list, species){
  tabledap(info,
           fields = variable_list,
           species,
           'maturity="Y"')
  }

# Plot relevant variables
plot_variables <- function(data){
  plot(table(data$year[data$catch > 0]),
       ylab = 'Frequency',
       xlab = 'Year',
       main = '')
  plot(table(data$julian[data$catch > 0]),
       ylab = 'Frequency',
       xlab = 'Day of Year',
       main = '')
  plot(table(data$latitude[data$catch > 0]),
       ylab = 'Frequency',
       xlab = 'Latitude',
       main = '')
  plot(table(data$longitude[data$catch > 0]),
       ylab = 'Frequency',
       xlab = 'Longitude',
       main = '')
  plot(table(data$station[data$catch > 0]),
       ylab = 'Frequency',
       xlab = 'Station',
       main = '')
  hist(data$catch, 
       breaks = 100,
       main = '',
       xlab = 'Catch') 
}

merge_data <- function(data1, data2){
  merge(data1, data2,
        by.x = c("cruise", "haul_no"),
        by.y = c("cruise", "haul_no"),
        all.x = F, all.y = T)
}

# Add the length ratios to the abundance data set
add_lengths <- function(species, lengths){
  lower <- aggregate(std_length ~ haul_no + cruise,
                         data = lengths,
                         FUN = length,
                         subset = std_length <= median(as.numeric(std_length), na.rm = T))
  yoy <- merge_data(lower, species)
  names(yoy)[names(yoy) == "std_length"] <- "lower_num"
  
  upper <- aggregate(std_length ~ haul_no + cruise,
                         data = lengths,
                         FUN = length,
                         subset = std_length > median(as.numeric(std_length), na.rm = T))
  yoy <- merge_data(upper, yoy)
  names(yoy)[names(yoy) == "std_length"] <- "upper_num"
  
  total <- aggregate(std_length ~ haul_no + cruise,
                         data = lengths,
                         FUN = length)
  yoy <- merge_data(total, yoy)
  names(yoy)[names(yoy) == "std_length"] <- "total_num"
  
  yoy$upper_cpue <- (yoy$upper_num / yoy$total_num) * yoy$catch
  yoy$lower_cpue <- (yoy$lower_num / yoy$total_num) * yoy$catch
  
  yoy$upper_cpue[is.na(yoy$upper_cpue)] <- 0
  yoy$lower_cpue[is.na(yoy$lower_cpue)] <- 0
  
  yoy_filtered <- yoy[yoy$year > min(lengths$year), ] # Length data only from 2013 onward
  return(yoy_filtered)
}
```

ERDDAP data
```{r}
# ERDDAP extraction
# RREAS
servers()
RREAS_info <- info('FED_Rockfish_Catch')
RREAS_list <- c('latitude', 'longitude',
                'cruise', 'ctd_index', 
                'haul_no', 'station',
                'bottom_depth', 'time',
                'maturity', 'catch')

RREAS_length_info <- info('FED_Rockfish_Length')
RREAS_length_list <- c('cruise', 'haul_no', 'latitude',
                       'station', 'time', 'bottom_depth',
                       'maturity', 'std_length')

# Create data sets for each species YOY
# Abundance
RREAS_hake <- extract_ERDDAP(RREAS_info, RREAS_list,
                             'sci_name="Merluccius productus"')
RREAS_sanddab <- extract_ERDDAP(RREAS_info, RREAS_list,
                                'sci_name="Citharichthys sordidus"')
RREAS_anchovy <- extract_ERDDAP(RREAS_info, RREAS_list,
                                'sci_name="Engraulis mordax"')
RREAS_widow <- extract_ERDDAP(RREAS_info, RREAS_list,
                              'sci_name="Sebastes entomelas"')
RREAS_shortbelly <- extract_ERDDAP(RREAS_info, RREAS_list,
                                   'sci_name="Sebastes jordani"')

# Change date format, add julian day
RREAS_list <- list(RREAS_hake, RREAS_sanddab, RREAS_anchovy, RREAS_widow, RREAS_shortbelly)
names(RREAS_list) <- c("hake", "sanddab", "anchovy", "widow", "shortbelly")
RREAS_list <- lapply(RREAS_list, function(x) {
  x$date <- as.Date(format(as.POSIXct(x$time, tz = "UTC", format = "%Y-%m-%d")))
  return(x)
  })
RREAS_list <- lapply(RREAS_list, function(x) {
  x %>% mutate(year = lubridate::year(date),
               month = lubridate::month(date),
               day = lubridate::day(date)) %>%
    mutate(julian = as.numeric(mdy.date(month, day, 1960)),
           latitude = as.numeric(latitude),
           longitude = as.numeric(longitude),
           bottom_depth = as.numeric(bottom_depth)) 
  })

# Lengths
length_hake <- extract_ERDDAP(RREAS_length_info, RREAS_length_list,
                             'sci_name="Merluccius productus"')
length_sanddab <- extract_ERDDAP(RREAS_length_info, RREAS_length_list,
                                'sci_name="Citharichthys sordidus"')
length_anchovy <- extract_ERDDAP(RREAS_length_info, RREAS_length_list,
                                'sci_name="Engraulis mordax"')
length_widow <- extract_ERDDAP(RREAS_length_info, RREAS_length_list,
                              'sci_name="Sebastes entomelas"')
length_shortbelly <- extract_ERDDAP(RREAS_length_info, RREAS_length_list,
                                   'sci_name="Sebastes jordani"')

# Change date format
length_list <- list(length_hake, length_sanddab, length_anchovy, length_widow, length_shortbelly)
names(length_list) <- c("hake", "sanddab", "anchovy", "widow", "shortbelly")
length_list <- lapply(length_list, function(x) {
  x$date <- format(as.POSIXct(x$time, tz = "UTC", format = "%Y-%m-%d"))
  return(x)
  })
length_list <- lapply(length_list, function(x) {
  mutate(x, year = lubridate::year(date),
         bottom_depth = as.numeric(bottom_depth),
         std_length = as.numeric(std_length),
         latitude = as.numeric(latitude))
  })
```

CTD data from ERDDAP
```{r}
RREAS_CTD_info <- info('FED_Rockfish_CTD')

ctds <- tabledap(RREAS_CTD_info,
                 fields = c('cruise', 'ctd_index',
                            'temperature', 'salinity', 
                            'oxygen', 'station',
                            'ctd_depth'),
                 'ctd_depth<=10')

cols <- c('temperature', 'salinity', 'oxygen')
ctds[cols] <- sapply(ctds[cols], as.numeric)

ctd_means <- ctds  %>%
  group_by(cruise, ctd_index, station) %>%
  summarise_at(vars('temperature', 'salinity', 'oxygen'), mean) %>%
  mutate_all(~ifelse(is.nan(.), NA, .)) 
```

Add CTD to abundance data
```{r}
RREAS_list_env <- lapply(RREAS_list, function(x) merge(x, ctd_means,
                                                       by = c('cruise', 
                                                              'ctd_index',
                                                              'station'),
                                                       all.x = T))
```

Add length ratios
```{r}
# Filter based on years with length data
yoy_hake <- add_lengths(RREAS_list_env[[1]], length_list[[1]])
yoy_sanddab <- add_lengths(RREAS_list_env[[2]], length_list[[2]])
yoy_anchovy <- add_lengths(RREAS_list_env[[3]], length_list[[3]])
yoy_widow <- add_lengths(RREAS_list_env[[4]], length_list[[4]])
yoy_shortbelly <- add_lengths(RREAS_list_env[[5]], length_list[[5]])
```


```{r}
# Save final dataframes
saveRDS(RREAS_list_env, file = "../data/RREAS_list.Rdata")
saveRDS(length_list, file = "../data/length_list.Rdata")
saveRDS(ctd_means, file = "../data/ctd_means.Rdata")
saveRDS(yoy_hake, file = "../data/yoy_hake.Rdata")
saveRDS(yoy_sanddab, file = "../data/yoy_sanddab.Rdata")
saveRDS(yoy_anchovy, file = "../data/yoy_anchovy.Rdata")
saveRDS(yoy_widow, file = "../data/yoy_widow.Rdata")
saveRDS(yoy_shortbelly, file = "../data/yoy_shortbelly.Rdata")
```

```{r}
# Full data
par(mfrow = c(2, 3))
plot_variables(RREAS_list[[1]])
plot_variables(RREAS_list[[2]])
plot_variables(RREAS_list[[3]])
plot_variables(RREAS_list[[4]])
plot_variables(RREAS_list[[5]])
```

```{r}
# Length limited data
par(mfrow = c(2, 3))
plot_variables(yoy_hake)
plot_variables(yoy_sanddab)
plot_variables(yoy_anchovy)
plot_variables(yoy_widow)
plot_variables(yoy_shortbelly)
```


```{r}
ggplot(length_list[[1]]) +
  geom_point(aes(bottom_depth, std_length),
                 alpha = 0.1,
                 size = 2)
ggplot(length_list[[2]]) +
  geom_point(aes(bottom_depth, std_length),
                 alpha = 0.1,
                 size = 2) 
ggplot(length_list[[3]]) +
  geom_point(aes(bottom_depth, std_length),
                 alpha = 0.1,
                 size = 2)
ggplot(length_list[[4]]) +
  geom_point(aes(bottom_depth, std_length),
                 alpha = 0.1,
                 size = 2)
ggplot(length_list[[5]]) +
  geom_point(aes(bottom_depth, std_length),
                 alpha = 0.1,
                 size = 2)
```

```{r}
range(length_list[[1]]$bottom_depth, na.rm = T)
length_list[[1]] %>%
  mutate(depth_cut = cut(bottom_depth, breaks = c(0, 250, 500, 750,
                                                  1000, 1250, 1500,
                                                  1750, 2000, 2250,
                                                  2500, 2750, 3000,
                                                  3250, 3500, 3750))) %>% 
  ggplot(aes(depth_cut, std_length)) +
  geom_boxplot()

range(length_list[[2]]$bottom_depth, na.rm = T)
length_list[[2]] %>%
  mutate(depth_cut = cut(bottom_depth, breaks = c(0, 250, 500, 750,
                                                  1000, 1250, 1500,
                                                  1750, 2000, 2250,
                                                  2500, 2750, 3000,
                                                  3250, 3500))) %>% 
  ggplot(aes(depth_cut, std_length)) +
  geom_boxplot()

range(length_list[[3]]$bottom_depth, na.rm = T)
length_list[[3]] %>%
  mutate(depth_cut = cut(bottom_depth, breaks = c(0, 250, 500, 750,
                                                  1000, 1250, 1500,
                                                  1750, 2000, 2250,
                                                  2500))) %>% 
  ggplot(aes(depth_cut, std_length)) +
  geom_boxplot()

range(length_list[[4]]$bottom_depth, na.rm = T)
length_list[[4]] %>%
  mutate(depth_cut = cut(bottom_depth, breaks = c(0, 250, 500, 750,
                                                  1000, 1250, 1500,
                                                  1750, 2000, 2250,
                                                  2500, 2750, 3000,
                                                  3250, 3500))) %>% 
  ggplot(aes(depth_cut, std_length)) +
  geom_boxplot()

range(length_list[[5]]$bottom_depth, na.rm = T)
length_list[[5]] %>%
  mutate(depth_cut = cut(bottom_depth, breaks = c(0, 250, 500, 750,
                                                  1000, 1250, 1500,
                                                  1750, 2000, 2250,
                                                  2500, 2750, 3000,
                                                  3300))) %>% 
  ggplot(aes(depth_cut, std_length)) +
  geom_boxplot()
```

```{r, fig.width = 10, fig.height = 5, warning = FALSE, echo = FALSE}
# polish boxplot for depth/length
length_list[[1]] %>%
  mutate(depth_cut = cut(bottom_depth, breaks = seq(0, 4000, by = 250))) %>% 
  ggplot() +
  geom_boxplot(aes(depth_cut, std_length),
               fill = "darkseagreen3", 
               outlier.alpha = 0.2) +  
  labs(y = "Length (mm)",
       x = "Depth (m)",
       title = "Size of YOY Hake by Depth") +
  scale_x_discrete(labels = c("0-250", "250-500", "500-750", "750-1000",
                              "1000-1250", "1250-1500", "1500-1750",
                              "1750-2000", "2000-2250", "2250-2500",
                              "2500-2750", "2750-3000", "3000-3250",
                              "3250-3500", "3500-3750", "3750-4000")) +
  theme_classic() +
  theme(panel.background = element_rect(fill = "gray91", colour = "gray91"),
        axis.line = element_blank(),
        axis.ticks = element_blank(),
        plot.title = element_text(size = 22, family = "serif", face = "bold"),
        axis.text = element_text(family = "serif", size = 14),
        axis.title = element_text(family = "serif", size = 18),
        axis.text.x = element_text(angle = 45, vjust = 0.7))

length_list[[2]] %>%
  mutate(depth_cut = cut(bottom_depth, breaks = seq(0, 3750, by = 250))) %>% 
  ggplot() +
  geom_boxplot(aes(depth_cut, std_length),
               fill = "darkseagreen3", 
               outlier.alpha = 0.2) +  
  labs(y = "Length (mm)",
       x = "Depth (m)",
       title = "Size of YOY Sanddab by Depth") +
  scale_x_discrete(labels = c("0-250", "250-500", "500-750", "750-1000",
                              "1000-1250", "1250-1500", "1500-1750",
                              "1750-2000", "2000-2250", "2250-2500",
                              "2500-2750", "2750-3000", "3000-3250",
                              "3250-3500", "3500-3750")) +
  theme_classic() +
  theme(panel.background = element_rect(fill = "gray91", colour = "gray91"),
        axis.line = element_blank(),
        axis.ticks = element_blank(),
        plot.title = element_text(size = 22, family = "serif", face = "bold"),
        axis.text = element_text(family = "serif", size = 14),
        axis.title = element_text(family = "serif", size = 18),
        axis.text.x = element_text(angle = 45, vjust = 0.7))

length_list[[3]] %>%
  mutate(depth_cut = cut(bottom_depth, breaks = seq(0, 2500, by = 125))) %>% 
  ggplot() +
  geom_boxplot(aes(depth_cut, std_length),
               fill = "darkseagreen3", 
               outlier.alpha = 0.2) +  
  labs(y = "Length (mm)",
       x = "Depth (m)",
       title = "Size of YOY Anchovy by Depth") +
  scale_x_discrete(labels = c("0-125", "125-250", "250-375", "375-500",
                              "500-625", "625-750", "750-875", "875-1000",
                              "1000-1125", "1125-1250", "1250-1375", 
                              "1375-1500", "1500-1625", "1625-1750",
                              "1750-1875", "1875-2000", "2000-2125",
                              "2125-2375", "2375-2500")) +
  theme_classic() +
  theme(panel.background = element_rect(fill = "gray91", colour = "gray91"),
        axis.line = element_blank(),
        axis.ticks = element_blank(),
        plot.title = element_text(size = 22, family = "serif", face = "bold"),
        axis.text = element_text(family = "serif", size = 14),
        axis.title = element_text(family = "serif", size = 18),
        axis.text.x = element_text(angle = 45, vjust = 0.7))

length_list[[4]] %>%
  mutate(depth_cut = cut(bottom_depth, breaks = seq(0, 4000, by = 250))) %>% 
  ggplot() +
  geom_boxplot(aes(depth_cut, std_length),
               fill = "darkseagreen3", 
               outlier.alpha = 0.2) +  
  labs(y = "Length (mm)",
       x = "Depth (m)",
       title = "Size of YOY Widow Rockfish by Depth") +
  scale_x_discrete(labels = c("0-250", "250-500", "500-750", "750-1000",
                              "1000-1250", "1250-1500", "1500-1750",
                              "1750-2000", "2000-2250", "2250-2500",
                              "2500-2750", "2750-3000", "3000-3250",
                              "3250-3500", "3500-3750", "3750-4000")) +
  theme_classic() +
  theme(panel.background = element_rect(fill = "gray91", colour = "gray91"),
        axis.line = element_blank(),
        axis.ticks = element_blank(),
        plot.title = element_text(size = 22, family = "serif", face = "bold"),
        axis.text = element_text(family = "serif", size = 14),
        axis.title = element_text(family = "serif", size = 18),
        axis.text.x = element_text(angle = 45, vjust = 0.7))

length_list[[5]] %>%
  mutate(depth_cut = cut(bottom_depth, breaks = seq(0, 3750, by = 250))) %>% 
  ggplot() +
  geom_boxplot(aes(depth_cut, std_length),
               fill = "darkseagreen3", 
               outlier.alpha = 0.2) +  
  labs(y = "Length (mm)",
       x = "Depth (m)",
       title = "Size of YOY Shortbelly Rockfish by Depth") +
  scale_x_discrete(labels = c("0-250", "250-500", "500-750", "750-1000",
                              "1000-1250", "1250-1500", "1500-1750",
                              "1750-2000", "2000-2250", "2250-2500",
                              "2500-2750", "2750-3000", "3000-3250",
                              "3250-3500", "3500-3750")) +
  theme_classic() +
  theme(panel.background = element_rect(fill = "gray91", colour = "gray91"),
        axis.line = element_blank(),
        axis.ticks = element_blank(),
        plot.title = element_text(size = 22, family = "serif", face = "bold"),
        axis.text = element_text(family = "serif", size = 14),
        axis.title = element_text(family = "serif", size = 18),
        axis.text.x = element_text(angle = 45, vjust = 0.7))
```

```{r}
# Investigate latitude
ggplot(length_list[[1]]) +
  geom_point(aes(latitude, std_length),
                 alpha = 0.1,
                 size = 2)
ggplot(length_list[[2]]) +
  geom_point(aes(latitude, std_length),
                 alpha = 0.1,
                 size = 2) 
ggplot(length_list[[3]]) +
  geom_point(aes(latitude, std_length),
                 alpha = 0.1,
                 size = 2)
ggplot(length_list[[4]]) +
  geom_point(aes(latitude, std_length),
                 alpha = 0.1,
                 size = 2)
ggplot(length_list[[5]]) +
  geom_point(aes(latitude, std_length),
                 alpha = 0.1,
                 size = 2)
```


```{r}
length_list[[1]] %>%
  mutate(latitude_cut = cut(latitude, breaks = seq(32, 48, by = 1))) %>% 
  ggplot(aes(latitude_cut, std_length)) +
  geom_boxplot()

length_list[[2]] %>%
  mutate(latitude_cut = cut(latitude, breaks = seq(32, 48, by = 1))) %>% 
  ggplot(aes(latitude_cut, std_length)) +
  geom_boxplot()

length_list[[3]] %>%
  mutate(latitude_cut = cut(latitude, breaks = seq(32, 48, by = 1))) %>% 
  ggplot(aes(latitude_cut, std_length)) +
  geom_boxplot()

length_list[[4]] %>%
  mutate(latitude_cut = cut(latitude, breaks = seq(32, 48, by = 1))) %>% 
  ggplot(aes(latitude_cut, std_length)) +
  geom_boxplot()

length_list[[5]] %>%
  mutate(latitude_cut = cut(latitude, breaks = seq(32, 48, by = 1))) %>% 
  ggplot(aes(latitude_cut, std_length)) +
  geom_boxplot()
```

```{r, fig.width = 10, fig.height = 5, warning = FALSE, echo = FALSE}
# polish boxplot for lat/length
length_list[[1]] %>%
  mutate(latitude_cut = cut(latitude, breaks = seq(32, 42, by = 1))) %>% 
  ggplot() +
  geom_boxplot(aes(latitude_cut, std_length),
               fill = "cyan3", 
               outlier.alpha = 0.2) +  
  labs(y = "Length (mm)",
       x = "Latitude",
       title = "Size of YOY Hake by Latitude") +
  scale_x_discrete(labels = c("32-33", "33-34", "34-35", "35-36", "36-37",
                              "37-38", "38-39", "39-40", "40-41", "41-42")) +
  theme_classic() +
  theme(panel.background = element_rect(fill = "gray91", colour = "gray91"),
        axis.line = element_blank(),
        axis.ticks = element_blank(),
        plot.title = element_text(size = 22, family = "serif", face = "bold"),
        axis.text = element_text(family = "serif", size = 14),
        axis.title = element_text(family = "serif", size = 18),
        axis.text.x = element_text(angle = 45, vjust = 0.7))

length_list[[2]] %>%
  mutate(latitude_cut = cut(latitude, breaks = seq(32, 42, by = 1))) %>% 
  ggplot() +
  geom_boxplot(aes(latitude_cut, std_length),
               fill = "cyan3", 
               outlier.alpha = 0.2) +  
  labs(y = "Length (mm)",
       x = "Latitude",
       title = "Size of YOY Sanddab by Latitude") +
  scale_x_discrete(labels = c("32-33", "33-34", "34-35", "35-36", "36-37",
                              "37-38", "38-39", "39-40", "40-41", "41-42")) +
  theme_classic() +
  theme(panel.background = element_rect(fill = "gray91", colour = "gray91"),
        axis.line = element_blank(),
        axis.ticks = element_blank(),
        plot.title = element_text(size = 22, family = "serif", face = "bold"),
        axis.text = element_text(family = "serif", size = 14),
        axis.title = element_text(family = "serif", size = 18),
        axis.text.x = element_text(angle = 45, vjust = 0.7))

length_list[[3]] %>%
  mutate(latitude_cut = cut(latitude, breaks = seq(32, 42, by = 1))) %>% 
  ggplot() +
  geom_boxplot(aes(latitude_cut, std_length),
               fill = "cyan3", 
               outlier.alpha = 0.2) +  
  labs(y = "Length (mm)",
       x = "Latitude",
       title = "Size of YOY Anchovy Latitude") +
  scale_x_discrete(labels = c("32-33", "33-34", "34-35", "35-36", "36-37",
                              "37-38", "38-39", "39-40", "40-41", "41-42")) +
  theme_classic() +
  theme(panel.background = element_rect(fill = "gray91", colour = "gray91"),
        axis.line = element_blank(),
        axis.ticks = element_blank(),
        plot.title = element_text(size = 22, family = "serif", face = "bold"),
        axis.text = element_text(family = "serif", size = 14),
        axis.title = element_text(family = "serif", size = 18),
        axis.text.x = element_text(angle = 45, vjust = 0.7))

length_list[[2]] %>%
  mutate(latitude_cut = cut(latitude, breaks = seq(32, 42, by = 1))) %>% 
  ggplot() +
  geom_boxplot(aes(latitude_cut, std_length),
               fill = "cyan3", 
               outlier.alpha = 0.2) +  
  labs(y = "Length (mm)",
       x = "Latitude",
       title = "Size of YOY Widow Rockfish by Latitude") +
  scale_x_discrete(labels = c("32-33", "33-34", "34-35", "35-36", "36-37",
                              "37-38", "38-39", "39-40", "40-41", "41-42")) +
  theme_classic() +
  theme(panel.background = element_rect(fill = "gray91", colour = "gray91"),
        axis.line = element_blank(),
        axis.ticks = element_blank(),
        plot.title = element_text(size = 22, family = "serif", face = "bold"),
        axis.text = element_text(family = "serif", size = 14),
        axis.title = element_text(family = "serif", size = 18),
        axis.text.x = element_text(angle = 45, vjust = 0.7))

length_list[[3]] %>%
  mutate(latitude_cut = cut(latitude, breaks = seq(32, 42, by = 1))) %>% 
  ggplot() +
  geom_boxplot(aes(latitude_cut, std_length),
               fill = "cyan3", 
               outlier.alpha = 0.2) +  
  labs(y = "Length (mm)",
       x = "Latitude",
       title = "Size of YOY Shortbelly Rockfish Latitude") +
  scale_x_discrete(labels = c("32-33", "33-34", "34-35", "35-36", "36-37",
                              "37-38", "38-39", "39-40", "40-41", "41-42")) +
  theme_classic() +
  theme(panel.background = element_rect(fill = "gray91", colour = "gray91"),
        axis.line = element_blank(),
        axis.ticks = element_blank(),
        plot.title = element_text(size = 22, family = "serif", face = "bold"),
        axis.text = element_text(family = "serif", size = 14),
        axis.title = element_text(family = "serif", size = 18),
        axis.text.x = element_text(angle = 45, vjust = 0.7))
```

```{r, include = FALSE, echo = FALSE}
# Make maps of catches
west_coast <- map_data("usa")
```

```{r, warning = FALSE, echo = FALSE}
ggplot() +  
  geom_polygon(aes(long, lat, group = group), data = west_coast,
               fill = "lightyellow4", 
               colour = "black") +
  geom_point(data = RREAS_list[[1]], 
            aes(as.numeric(longitude), as.numeric(latitude),
                size = catch),
            color = "salmon") +
  coord_quickmap(xlim = c(-126, -117), ylim = c(32, 42))

ggplot() +  
  geom_polygon(aes(long, lat, group = group), data = west_coast,
               fill = "lightyellow4", 
               colour = "black") +
  geom_point(data = RREAS_list[[2]], 
            aes(as.numeric(longitude), as.numeric(latitude),
                size = catch),
            color = "salmon") +
  coord_quickmap(xlim = c(-126, -117), ylim = c(32, 42))

ggplot() +  
  geom_polygon(aes(long, lat, group = group), data = west_coast,
               fill = "lightyellow4", 
               colour = "black") +
  geom_point(data = RREAS_list[[3]], 
            aes(as.numeric(longitude), as.numeric(latitude),
                size = catch),
            color = "salmon") +
  coord_quickmap(xlim = c(-126, -117), ylim = c(32, 42))

ggplot() +  
  geom_polygon(aes(long, lat, group = group), data = west_coast,
               fill = "lightyellow4", 
               colour = "black") +
  geom_point(data = RREAS_list[[4]], 
            aes(as.numeric(longitude), as.numeric(latitude),
                size = catch),
            color = "salmon") +
  coord_quickmap(xlim = c(-126, -117), ylim = c(32, 42))

ggplot() +  
  geom_polygon(aes(long, lat, group = group), data = west_coast,
               fill = "lightyellow4", 
               colour = "black") +
  geom_point(data = RREAS_list[[5]], 
            aes(as.numeric(longitude), as.numeric(latitude),
                size = catch),
            color = "salmon") +
  coord_quickmap(xlim = c(-126, -117), ylim = c(32, 42))
```
